# ğŸ 2025-8-1

ğŸ† æ’åï¼š162åŒå‘¨èµ›ï¼ˆ475 / 1211ï¼‰ã€461ï¼ˆ161/1633ï¼‰

ğŸˆ è¿‡é¢˜æ•°ï¼š3ï¼Œ4

ğŸ”– ç®—æ³•æ ‡ç­¾ï¼šè«é˜Ÿ

# ğŸ’­ å¤ç›˜

162åŒå‘¨èµ›æ‰“çš„ä¸€å¨ã€‚ç¬¬ä¸‰é“é¢˜é€‰äº†éº»çƒ¦çš„è§£æ³•ï¼Œå¹¶ä¸”è¾¹ç•Œå¤„ç†å‡ºäº†å¾ˆå¤šé—®é¢˜ã€‚è¿™æ¬¡è¡¥ä½“ç¬¬å››é¢˜ç®—æ³•æ˜¯è«é˜Ÿç½šåç®—æ³•ã€‚

# ğŸª¾è¡¥é¢˜

## [Q3. æœ€æ—©å®Œæˆé™†åœ°å’Œæ°´ä¸Šæ¸¸ä¹è®¾æ–½çš„æ—¶é—´ II](https://leetcode.cn/contest/biweekly-contest-162/problems/earliest-finish-time-for-land-and-water-rides-ii/)

![image-20250804135933293](https://raw.githubusercontent.com/ChenXuRiYue/image-cloud/main/typora/image-20250804135933293.png)

**è¡¥é¢˜ç±»å‹ï¼š** ç é£ä¼˜åŒ–ï¼Œæ›´ä¼˜æ€è·¯ã€‚

åŸæ€è·¯ï¼šå‡è®¾ä»é™†åœ°é€‰å‡ºè®¾æ–½ä¸º aï¼Œä»æ°´ä¸Šæ¸¸ä¹è®¾æ–½é€‰å‡ºä¸ºbã€‚æ˜¾ç„¶æœ€ä¼˜ç§€è§£ä¸­è‡³å°‘ aï¼Œæˆ– b æ˜¯æ»¡è¶³æ¡ä»¶ç«‹åˆ»å¯åŠ¨çš„ã€‚å› æ­¤è€ƒè™‘æšä¸¾ç«‹åˆ»å¯åŠ¨çš„æ¸¸ä¹è®¾æ–½ç®—å‡ºå¯¹åº”çš„æœ€ä¼˜æ–¹æ¡ˆï¼Œæœ€åç»¼åˆå–æœ€å°å€¼åˆ™ä¸ºæœ€ä¼˜æ–¹æ¡ˆã€‚

è€ƒè™‘ æšä¸¾ aï¼Œ åˆ™å¯èƒ½æƒ…å†µä¸º $baã€ab_0ã€ab$ ä¸‰ç§æƒ…å½¢ã€‚å…¶ä¸­ $b$ è¡¨ç¤ºæ»¡è¶³æ¡ä»¶å³åˆ»å¼€å§‹æ¸¸ç©çš„è®¾æ–½ã€‚ $b_0$ åˆ™ä¸ä¹‹ç›¸åï¼Œæ»¡è¶³æ¡ä»¶è¿‡ä¸€æ®µæ—¶é—´åæ‰å¼€å§‹æ¸¸ç©ã€‚

**å®šä¹‰**ï¼š

1. $f(x)$ è¡¨ç¤ºæ¸¸ä¹è®¾æ–½ $x$ çš„æœ€æ—©å¼€å§‹æ—¶é—´
2. $g(x)$ è¡¨ç¤ºæ¸¸ä¹è®¾æ–½ $x$ çš„æœ€æ—©ç»“æŸæ—¶é—´
3. $l(x)$ è¡¨ç¤ºæ¸¸ä¹è®¾æ–½ $x$ çš„æŒç»­æ—¶é—´

å¯¹äº $ba$ï¼Œæ€»æ˜¯æ»¡è¶³ $ba = f(a)$ è‹¥å­˜åœ¨  $g(b) <= f(a)$
å¯¹äº $ab_0$ï¼Œæœ€ä¼˜è§£ä¸º $g(a) + min\{l(x),f(x) <= g(a)\}$
å¯¹äº $ab$ï¼Œæœ€ä¼˜è§£ä¸º $min\{g(x)/f(x) \ge g(a)\}$

åè¿‡æ¥å†æšä¸¾ä¸€é $b$

äºæ˜¯ç”¨æœ€è ¢çš„æ–¹æ³•ï¼Œç¡¬ç¼–ç äº†ä¸¤æ®µæšä¸¾ï¼Œå› ä¸ºä¿®æ”¹ä¸æ°ï¼Œå¤šè´¡çŒ®äº†å‡ ä¸ªç½šæ—¶ã€‚

```c++
class Solution {
public:
    int earliestFinishTime(vector<int>& ls, vector<int>& ld, vector<int>& ws, vector<int>& wd) {
        int n = ls.size(), m = ws.size();
        vector<array<int, 2>> a, b;
        for(int i = 0; i < n; i++) {
            a.push_back({ls[i], ls[i] + ld[i]});
        }
        for(int i = 0; i < m; i++) {
            b.push_back({ws[i], ws[i] + wd[i]});
        }
        sort(a.begin(), a.end());
        sort(b.begin(), b.end());
        // a
        const int inf = 1E9 + 7;
        vector<int> suf(m + 1), pre(m + 1);
        suf[m] = inf;
        for(int i = m - 1; i >= 0; i--) {
            suf[i] = min(suf[i + 1], b[i][1]);
        }
        for(int i = 0; i < m; i++) {
            if(i == 0) {
                pre[i] = b[i][1] - b[i][0];
            }else {
                pre[i] = min(pre[i - 1], b[i][1] - b[i][0]);
            }
        }
        // for(int i = 0; i < m; i++) {
        //     cout << b[i][0] << " " << b[i][1] << "\n";
        //     cout << pre[i] << " \n";
        // }
        
        int ans = inf;
        for(int i = 0 ; i < n; i++) {
            //x a
            if(a[i][0] >= b[0][1]) {
                ans = min(ans, a[i][1]);
            }
            int id = upper_bound(b.begin(), b.end(), array<int, 2>{a[i][1], 0}) - b.begin();
            // cout << "==== \n";
            // cout << "id " << id << " ans" << ans <<" a[i][0] " << a[i][0] << " a[i][1]" << a[i][1] <<  "\n";
            if(id == m) {
                ans = min(ans, a[i][1] + pre[m - 1]);
            } else if(id == 0) {
                ans = min(ans, suf[id]);
            } else {
                ans = min({ans, a[i][1] + pre[id - 1], suf[id]});
            }
        }

        suf = vector<int> (n + 1);
        pre = vector<int>(n + 1);
        suf[n] = inf;
        for(int i = n - 1; i >= 0; i--) {
            suf[i] = min(suf[i + 1], a[i][1]);
        }
        for(int i = 0; i < n; i++) {
            if(i == 0) {
                pre[i] = a[i][1] - a[i][0];
            }else {
                pre[i] = min(pre[i - 1], a[i][1] - a[i][0]);
            }
        }
        
        for(int i = 0; i < m; i++) {
            //x a
            if(b[i][0] >= a[0][1]) {
                ans = min(ans, b[i][1]);
            }
            int id = upper_bound(a.begin(), a.end(), array<int, 2>{b[i][1], 0}) - a.begin();
            if(id == n) {
                ans = min(ans, b[i][1] + pre[n - 1]);
            } else if(id == 0) {
                ans = min(ans, suf[id]);
            } else {
                ans = min({ans, b[i][1] + pre[id - 1], suf[id]});
            }
        }
        return ans;
        
    }
};
```

**ä¼˜åŒ–**

ä¸éš¾å‘ç°å®ƒä»¬æ˜¯å¯¹ç§°çš„ï¼Œå®Œå…¨å¯ä»¥å°†ä¸Šè¿°è¿‡ç¨‹æŠ½è±¡ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œæœ€åè°ƒæ•´å…¥å‚å³å¯

**ä¼˜åŒ–åçš„ä»£ç **

```c++
class Solution {
public:
    int earliestFinishTime(vector<int>& ls, vector<int>& ld, vector<int>& ws, vector<int>& wd) {
        return min(solve(ls, ld, ws, wd), solve(ws, wd, ls, ld));
    }
    int solve(vector<int>& ls, vector<int>& ld, vector<int>& ws, vector<int>& wd) {
        int n = ls.size(), m = ws.size();
        vector<array<int, 2>> a, b;
        for(int i = 0; i < n; i++) {
            a.push_back({ls[i], ls[i] + ld[i]});
        }
        for(int i = 0; i < m; i++) {
            b.push_back({ws[i], ws[i] + wd[i]});
        }
        sort(a.begin(), a.end());
        sort(b.begin(), b.end());
        // a
        const int inf = 1E9 + 7;
        vector<int> suf(m + 1), pre(m + 1);
        suf[m] = inf;
        for(int i = m - 1; i >= 0; i--) {
            suf[i] = min(suf[i + 1], b[i][1]);
        }
        for(int i = 0; i < m; i++) {
            if(i == 0) {
                pre[i] = b[i][1] - b[i][0];
            }else {
                pre[i] = min(pre[i - 1], b[i][1] - b[i][0]);
            }
        }
        
        int ans = inf;
        for(int i = 0 ; i < n; i++) {
            //x a
            if(a[i][0] >= b[0][1]) {
                ans = min(ans, a[i][1]);
            }
            int id = upper_bound(b.begin(), b.end(), array<int, 2>{a[i][1], 0}) - b.begin();
            if(id == m) {
                ans = min(ans, a[i][1] + pre[m - 1]);
            } else if(id == 0) {
                ans = min(ans, suf[id]);
            } else {
                ans = min({ans, a[i][1] + pre[id - 1], suf[id]});
            }
        }
        return ans;
    }
};
```

## [Q4. æŸ¥è¯¢è¶…è¿‡é˜ˆå€¼é¢‘ç‡æœ€é«˜å…ƒç´ ](https://leetcode.cn/contest/biweekly-contest-162/problems/threshold-majority-queries/)

<img src="https://raw.githubusercontent.com/ChenXuRiYue/image-cloud/main/typora/image-20250804141516123.png" alt="image-20250804141516123" style="zoom:50%;" />

${\large {\color[RGB]{250, 157, 30}æ€è·¯åˆ†æ}} $

**åŸºæœ¬æ€è·¯ï¼š** è¿™ç§é—®é¢˜æ˜¾ç„¶æ˜¯ç»´æŠ¤ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œè€Œç»´æŠ¤çº¿æ®µæ ‘çš„ä¸€ä¸ªç—›ç‚¹æ˜¯ä¼—æ•°å€¼åŸŸè¿‡å¤§ï¼Œéš¾ä»¥ç»´æŠ¤ä¿¡æ¯ã€‚å³ä½¿å¯¹æ•°å­—è¿›è¡Œç¦»æ•£åŒ–ï¼ŒåŒºé—´çš„ä¿®æ”¹ï¼Œåˆå¹¶ç­‰æ“ä½œå¤æ‚åº¦éƒ½å°†ä¼šéå¸¸å¤§ã€‚

å¦‚æœæ˜¯æš´åŠ›çš„ç»´æŠ¤å¤„ç†ï¼Œå¤æ‚åº¦æ˜¾ç„¶æ˜¯ $O(n^2)$ã€‚åœ¨è¿™ä¸ªæš´åŠ›çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¸€ä¸ªæ•°å­—æ€»æ˜¯è¢«å¤šä¸ªåŒºé—´è¯¢é—®çš„ï¼Œæ€ä¹ˆè®¾è®¡ä¸€ä¸ªç®—æ³•æœ€å¤§é™åº¦çš„é˜²æ­¢ä¸€ä¸ªåŒºé—´è¢«é‡å¤å¤„ç†å‘¢ï¼Ÿ

å¼•å‡º **è«é˜Ÿ**ï¼Œå…·ä½“çœ‹ **learning** æ•™ç¨‹ã€‚

**åˆ é™¤å…ƒç´ æ—¶ä¿¡æ¯ç»´æŠ¤**

1. æ ¹æ®æ•°é‡å¼€ $set$ æ•°ç»„ $set[N]$ ç»´æŠ¤ã€‚æ€»å¤æ‚åº¦ï¼š$O(n\sqrt q log_n)$
2. æ ¹æ®æ•°é‡å¼€ $bitset$ æ•°ç»„ $bitset[N]$ã€‚æ€»å¤æ‚åº¦ï¼š$O(\frac {n\sqrt q )\times 10000}{64})$

**é¿å…åˆ é™¤å…ƒç´ **

å¯ä»¥ä½¿ç”¨å›æ»šè«é˜Ÿ



${\large {\color[RGB]{250, 157, 30}Code-1}} $

ä½¿ç”¨ $set$ ç»´æŠ¤å³å¯

```C++
struct message {
  // ç»´æŠ¤åŸºæœ¬ä¿¡æ¯
  vector<set<int>> cunt;
  vector<int> mp;
  int miNum, mxCunt;
  // åˆå§‹åŒ–
  message(int n) {
    cunt.resize(n + 1);
    mp.resize(n + 1);
    miNum = 1E9 + 7, mxCunt = 0;
  }
  // å¢åŠ å…ƒç´ 
  void add(int x) {
    // å¢åŠ é€»è¾‘
    int x_cunt = mp[x];
    mp[x] = x_cunt + 1;
    cunt[x_cunt].erase(x);
    cunt[++x_cunt].insert(x);
    if(x_cunt > mxCunt) {
        mxCunt = x_cunt;
        miNum = x;
    } else if(x_cunt == mxCunt) {
        miNum = min(miNum, x);
    }
  }

  // åˆ é™¤å…ƒç´ 
  void del(int x) {
    // åˆ é™¤é€»è¾‘
    int x_cunt = mp[x];
    mp[x] = x_cunt - 1;
    cunt[x_cunt].erase(x);
    cunt[--x_cunt].insert(x);

    // åŸæ¥ä¸æ˜¯æœ€é«˜
    if(x_cunt + 1 != mxCunt) {
        return;
    } 
    // åŸæ¥æ˜¯æœ€é«˜
    // 1. è¿˜æœ‰å…ƒç´ 
    if(cunt[x_cunt + 1].size()) {
        miNum = *cunt[x_cunt + 1].begin();
    }
    // æ²¡æœ‰å…ƒç´ äº†
    else {
        mxCunt = x_cunt;
        miNum = *cunt[x_cunt].begin();
    }
  }

  // è·å–å½“å‰åŒºé—´çŠ¶æ€ç­”æ¡ˆã€‚
  int getAns(int limit) {
    if(mxCunt >= limit) return miNum; 
    else return -1;
  }
};

class Solution {
public:
    vector<int> subarrayMajority(vector<int>& nums, vector<vector<int>>& queries) {
        int n = nums.size();
        int m = queries.size();
        int B = 2 * (n + (int)sqrt(m) - 1) / (int)sqrt(m);

        // é‡æ–°æ’åº è¯¢é—®
        vector<int> qids(m);
        std::iota(qids.begin(), qids.end(), 0);
        sort(qids.begin(), qids.end(), [&](const int& x, const int& y) {
            int xb = queries[x][0]/B, yb = queries[y][0]/B;
            if(xb != yb) return xb < yb;
            else return queries[x][1] < queries[y][1];
        });

        // ç¦»æ•£åŒ–ã€‚
        auto dit = nums;
        sort(dit.begin(), dit.end());
        dit.erase(unique(dit.begin(), dit.end()), dit.end());
        // ä¿æŒç¦»æ•£åŒ–ã€‚
        vector<int> num_dit(n);
        for(int i = 0; i < n; i++) {
            int ditId = lower_bound(dit.begin(), dit.end(), nums[i]) - dit.begin();
            num_dit[i] = ditId;
        }

        message msg = message(n);

        vector<int> ans(m);

        
        // å¤„ç†è¯¢é—®
        int L = 0,  R = -1;
        for(int i = 0; i < m; i++) {
            int l = queries[qids[i]][0];
            int r = queries[qids[i]][1];
            int limit = queries[qids[i]][2];
            
            while(R < r) msg.add(num_dit[++R]);
            while(R > r) msg.del(num_dit[R--]);

            while(L < l) msg.del(num_dit[L++]);
            while(L > l) msg.add(num_dit[--L]);

            int tans = msg.getAns(limit);
            if(tans == -1) ans[qids[i]] = -1;
            else ans[qids[i]] = dit[tans];
        }
        return ans;
    }
};
```

å¦‚æœä¾ç„¶å‡ºç°å¸¸æ•°é—®é¢˜å¯ä»¥é€‚å½“é™ B è°ƒå¤§ã€‚åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œè°ƒæ•´$B = 2\frac{n}{\sqrt{m}}$ æ‰æˆåŠŸé€šè¿‡æœ€åä¸€ä¸ªç”¨ä¾‹ã€‚
