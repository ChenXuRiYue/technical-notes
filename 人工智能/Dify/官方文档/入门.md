# 📌 入门

**Dify** 是一个用于构建 AI 工作流的开源平台。通过在可视化画布上编排 AI 模型、连接数据源、定义处理流程，直接将你的领域知识转化为可运行的软件。

## 📗 30 分钟示例

下述是一个 Dify 的例子：根据输入资料，生成不同平台的帖子

#### 📝 1. 用户输入节点
用户收集的信息平台界面上可以直接调用。平台外可以通过 api 调用.

#### 📝 2. 参数提取节点：识别目标平台 

Parameter Extractor Node: Identify Target Platforms
该节点用于处理复杂用户输入，输出标准化信息

#### 📝 3. IF/ELSE Node：Validate Platform Extraction Results

分支逻辑
和普通的编程分支不同。由于 LLM 能力，增强了自然语言的判断条件。

![If Condition](https://raw.githubusercontent.com/ChenXuRiYue/image-cloud/main/global/deeper_dive_if.png)

#### 📝 4. List Operator Node: Separate Uploaded Files by Type

列表操作器节点：按类型分离上传的文件。

适应场景（一种文件如文本类型文件可以直接被 LLM 处理。另外一类需要转换成文档）

#### 📝 5. Doc Extractor Node: Extract Text from Documents
文档提取器：从文档中提取文本
即从 PDF、DOCX 这样的上传文件提取文档信息

#### 📝  6. LLM Node: Integrate All Reference Materials

LLM 节点：整合所有参考资料。

Dify 中的基本使用方法：

- 添加 LLM 节点

- 配置 LLM 节点

  - 重命名

  - 选取支持整合参考资料能力的模型（如支持视觉）

  - 填写系统提示词。引入资料.

    一个系统提示词示例子

    ```markdown
    # 提供的材料
    Doc Extractor/text
    User Input/draft
    
    # 角色与任务
    你是一名内容策略师。分析提供的材料并为多平台社交媒体优化创建综合内容基础。
    
    # 分析原则
    - 仅使用提供的信息——不做外部假设
    - 专注于提取、综合和战略解释
    - 识别引人注目和可操作的元素
    - 准备可跨不同平台调整的见解
    
    # 所需分析
    提供结构化分析：
    
    ## 1. 核心信息
    - 中心主题、目的、目标
    - 传达的关键价值或利益
    
    ## 2. 基本内容元素
    - 主要主题、事实、统计数据、数据点
    - 值得注意的引言、推荐、关键陈述
    - 提到的特性、利益、特征
    - 日期、地点、背景细节
    
    ## 3. 战略见解
    - 使内容引人注目/独特的原因
    - 存在的情感/理性诉求
    - 可信度因素、证明点
    - 突出的竞争优势
    
    ## 4. 参与机会
    - 出现的讨论点、问题
    - 建议的行动号召、下一步
    - 互动/参与机会
    - 涉及的热门主题
    
    ## 5. 平台优化基础
    - 高影响力：快速、可分享的格式
    - 专业：以商业为重点的讨论
    - 社区：互动和分享
    - 视觉：通过强大的视觉效果增强
    
    ## 6. 支持细节
    - 指标、数字、可量化的结果
    - 直接引言、推荐
    - 技术细节、规格
    - 可用的背景上下文
    ```

#### 📝 7. Iteration Node: Create Customized Content for Each Platform

迭代节点：为每个平台创建定制内容

#### 📝 8. 模板节点：格式化最终输出

迭代节点，输出了不同平台的原始数据数组。
引入一个模版节点：将原始分析数据组织成良好的节点。

#### 📝  9. 输出节点：将结果返回给用户

设置输出变量。
输出节点的输出变量与上一个节点怎么关联？

- 每个节点都会有对应的输出字段。（K V 形式）

## 📘 核心概念

### Dify 应用

Dify 专为智能体应用构建而设计。在 **Studio** 中，你可以通过拖拽界面快速构建智能体工作流并将其发布为应用。

- 使用
  - API、Web、或作为 MCP 服务器访问已发布应用
- 类型
  - **工作流**
  - **对话流**
  - 聊天机器人
  - 智能代理
  - 文本生成器

### 工作流

在 **Dify 平台**中，**工作流（Workflow）** 是一种可视化编排 AI 应用逻辑的方式，允许你通过拖拽节点、连接数据流，构建复杂的多步骤 AI 任务（如多轮对话、工具调用、条件分支、数据处理等）。

**开始节点：**

- 用户输入：直接用户交互 或 API 调用触发应用程序
- 触发器：应用程序按计划自动运行或响应特定的第三方事件

### 对话流

对话流是一种特殊类型的工作流应用，在对话的每一轮都会被触发。

- 具有存储和更新自定义对话特定变量的能力
- 不能使用触发器启动

### Dify 领域特定语言

#### 变量

变量是存储信息的标记容器。

有以下不同类型：

- 输入：You can specify any number of input variables at the [User Input](https://docs.dify.ai/en/use-dify/nodes/user-input) node for your app’s end users to fill in.

  ![CleanShot 2025-08-04 at 14.34.04@2x.png](https://raw.githubusercontent.com/ChenXuRiYue/image-cloud/main/global/CleanShot2025-08-04at14.34.04%25402x.png)

  输入节点，还带有一组输入变量：（这是系统提供的）

  | 变量名                | 数据类型 | 描述                                                         | 注释                                                         |
  | :-------------------- | :------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
  | `sys.user_id`         | String   | 用户 ID：系统在用户使用工作流应用程序时自动分配给每个用户的唯一标识符。用于区分不同的用户。 |                                                              |
  | `sys.app_id`          | String   | 应用程序 ID：系统自动分配给每个应用程序的唯一标识符。此参数用于记录当前应用程序的基本信息。 | 此参数用于具有开发能力的用户区分和定位不同的工作流应用程序。 |
  | `sys.workflow_id`     | String   | 工作流 ID：此参数记录当前工作流应用程序中所有节点的信息。    | 此参数可供具有开发能力的用户用于跟踪和记录工作流中包含的节点信息。 |
  | `sys.workflow_run_id` | String   | 工作流运行 ID：用于记录工作流应用程序的运行时状态和执行日志。 | 此参数可供具有开发能力的用户用于跟踪应用程序的历史执行记录。 |
  | `sys.timestamp`       | Number   | 每次工作流执行的开始时间。                                   |                                                              |

- 输出：每个节点产生一个或多个输出，可以在后续节点中引用。

- 环境变量：使用环境变量来存储应用特定的敏感信息，如 API 密钥

- 会话变量（仅对话流）

  - 多轮对话流中持续存在。
  - 可以通过变量分配器节点更新会话变量的值

#### 变量引用

配置输入字段时候，通过 下拉菜单 + 斜杠 / 变量引用插入到复杂文本输入中。