# ğŸ“ å¯åŠ¨æŠ¥é”™

æ€»ç»“ Spring å¯åŠ¨æŠ¥é”™æ—¥å¿—ä»¥åŠè§£å†³æ–¹æ³•ã€‚é¡ºä¾¿æ€»ç»“ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„ Spring è¯­å¢ƒä¸‹çš„æ—¥å¿—é˜…è¯»æ–¹æ³•æŠ€å·§

## ğŸ“œ ç›®å½•

[TOC]

## ğŸ“Œ æ–¹æ³•æ€»ç»“

### ğŸ”– æ—¥å¿—ç»“æ„

åœ¨ç»Šè„šçŸ³å †ä¸­ï¼Œå¯¹æ¯ä¸ªæ—¥å¿—æ€»ç»“ã€‚

## ğŸ“Œ ç»Šè„šçŸ³å †

### ğŸ”–01 spring å†…åµŒ web å®¹å™¨å¯åŠ¨å¤±è´¥

```markdown
org.springframework.context.ApplicationContextException: **Unable to start web server**; nested exception is org.springframework.context.ApplicationContextException: Unable to start ServletWebServerApplicationContext due to missing ServletWebServerFactory bean.
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:163) ~[spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:577) ~[spring-context-5.3.22.jar:5.3.22]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:145) ~[spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:745) [spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:420) [spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) [spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1317) [spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1306) [spring-boot-2.6.11.jar:2.6.11]
	at com.operation.xxxxAiMusicOperationApplication.main(AiMusicOperationApplication.java:25) [classes/:?]
Caused by: org.springframework.context.ApplicationContextException: Unable to start ServletWebServerApplicationContext due to missing ServletWebServerFactory bean.
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getWebServerFactory(ServletWebServerApplicationContext.java:210) ~[spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:180) ~[spring-boot-2.6.11.jar:2.6.11]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:160) ~[spring-boot-2.6.11.jar:2.6.11]
```

**ç»“æ„åˆ†æï¼š**

**1. ä¸»å¼‚å¸¸**

```txt
org.springframework.context.ApplicationContextException: 
Unable to start web server; 
nested exception is ... 
```

**2.åµŒå¥—å¼‚å¸¸**

```txt
nested exception is org.springframework.context.ApplicationContextException: Unable to start ServletWebServerApplicationContext due to missing ServletWebServerFactory bean.
```

**3.å †æ ˆè°ƒç”¨é“¾ï¼ˆå®šä½ä¸Šä¸‹æ–‡ï¼‰**

å› ä¸ºæ˜¯ä¸€ä¸ªæ ˆç»“æ„ï¼Œä»ä¸‹å¾€ä¸Šçœ‹ï¼Œæ‰¾åˆ°ä»£ç å…¥å£ï¼š

```txt
at com.axel.demo.aimusic.operation.xxxxAiMusicOperationApplication.main(xxxxAiMusicOperationApplication.java:25)
```

${\large {\color[RGB]{250, 157, 30}ç»“è®º}} $

Application ä¸»ç±»æœªä½¿ç”¨ @SpringBootApplicationã€‚
@SpringBootApplication æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼ŒåŒ…å«äº†ä»¥ä¸‹å…³é”®åŠŸèƒ½ï¼š

```java
@SpringBootConfiguration
@EnableAutoConfiguration  // â† è‡ªåŠ¨é…ç½®åµŒå…¥å¼ Web å®¹å™¨ï¼ˆå¦‚ Tomcatï¼‰
@ComponentScan
```

### ğŸ”– 02 åˆ›å»º bean æ—¶ç¼º jar åŒ…

```markdown
> 2025-12-18 15:59:34.122 ERROR 73727 - [main][traceId=] (o.s.b.SpringApplication.reportFailure.835)
   Application run failed

  org.springframework.beans.factory.BeanCreationException: **Error creating bean with name 
  'traceMapperAspect': Lookup method resolution failed;** nested exception is 
  java.lang.IllegalStateException: Failed to introspect Class 
  [com.axel.demo.xxxxcommonutil.aop.aspect.TraceMapperAspect] from ClassLoader 
  [sun.misc.Launcher$AppClassLoader@18b4aac2]
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCand
  idateConstructors(AutowiredAnnotationBeanPostProcessor.java:289) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstruct
  orsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1302) 
  ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance
  (AbstractAutowireCapableBeanFactory.java:1219) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(Abstr
  actAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(Abstrac
  tAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFa
  ctory.java:335) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSing
  letonBeanRegistry.java:234) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.jav
  a:333) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:
  208) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(D
  efaultListableBeanFactory.java:955) ~[spring-beans-5.3.22.jar:5.3.22]
  at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(
  AbstractApplicationContext.java:918) ~[spring-context-5.3.22.jar:5.3.22]
  at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationConte
  xt.java:583) ~[spring-context-5.3.22.jar:5.3.22]
  at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(Servlet
  WebServerApplicationContext.java:145) ~[spring-boot-2.6.11.jar:2.6.11]
  at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:745) 
  [spring-boot-2.6.11.jar:2.6.11]
  at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:420) 
  [spring-boot-2.6.11.jar:2.6.11]
  at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) 
  [spring-boot-2.6.11.jar:2.6.11]
  at org.springframework.boot.SpringApplication.run(SpringApplication.java:1317) 
  [spring-boot-2.6.11.jar:2.6.11]
  at org.springframework.boot.SpringApplication.run(SpringApplication.java:1306) 
  [spring-boot-2.6.11.jar:2.6.11]
  at com.axel.demo.aimusic.operation.xxxxAiMusicOperationApplication.main(xxxxAiMusicOperationAppl
  ication.java:26) [classes/:?]
  Caused by: java.lang.IllegalStateException: Failed to introspect Class 
  [com.axel.demo.xxxxcommonutil.aop.aspect.TraceMapperAspect] from ClassLoader 
  [sun.misc.Launcher$AppClassLoader@18b4aac2]
  at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:485) 
  ~[spring-core-5.3.22.jar:5.3.22]
  at org.springframework.util.ReflectionUtils.doWithLocalMethods(ReflectionUtils.java:321) 
  ~[spring-core-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCand
  idateConstructors(AutowiredAnnotationBeanPostProcessor.java:267) ~[spring-beans-5.3.22.jar:5.3.22]
  ... 18 more
  Caused by: java.lang.NoClassDefFoundError: org/aspectj/lang/ProceedingJoinPoint
  at java.lang.Class.getDeclaredMethods0(Native Method) ~[?:1.8.0_452]
  at java.lang.Class.privateGetDeclaredMethods(Class.java:2729) ~[?:1.8.0_452]
  at java.lang.Class.getDeclaredMethods(Class.java:2003) ~[?:1.8.0_452]
  at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:467) 
  ~[spring-core-5.3.22.jar:5.3.22]
  at org.springframework.util.ReflectionUtils.doWithLocalMethods(ReflectionUtils.java:321) 
  ~[spring-core-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCand
  idateConstructors(AutowiredAnnotationBeanPostProcessor.java:267) ~[spring-beans-5.3.22.jar:5.3.22]
  ... 18 more
  **Caused by**: java.lang.ClassNotFoundException: org.aspectj.lang.ProceedingJoinPoint
  at java.net.URLClassLoader.findClass(URLClassLoader.java:387) ~[?:1.8.0_452]
  at java.lang.ClassLoader.loadClass(ClassLoader.java:418) ~[?:1.8.0_452]
  at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352) ~[?:1.8.0_452]
  at java.lang.ClassLoader.loadClass(ClassLoader.java:351) ~[?:1.8.0_452]
  at java.lang.Class.getDeclaredMethods0(Native Method) ~[?:1.8.0_452]
  at java.lang.Class.privateGetDeclaredMethods(Class.java:2729) ~[?:1.8.0_452]
  at java.lang.Class.getDeclaredMethods(Class.java:2003) ~[?:1.8.0_452]
  at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:467) 
  ~[spring-core-5.3.22.jar:5.3.22]
  at org.springframework.util.ReflectionUtils.doWithLocalMethods(ReflectionUtils.java:321) 
  ~[spring-core-5.3.22.jar:5.3.22]
  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCand
  idateConstructors(AutowiredAnnotationBeanPostProcessor.java:267) ~[spring-beans-5.3.22.jar:5.3.22]
  ... 18 more
```

**æ’æŸ¥æ­¥éª¤**

1. æ— è§†è¡¨è±¡ï¼š**Error creating bean with name  'traceMapperAspect'**ï¼ˆæ— æ³•æˆåŠŸåˆ›å»ºä¸€ä¸ªçœ‹ä¸Šå»åƒåˆ‡é¢çš„ beanï¼‰

2. å¯»æ‰¾æœ€åº•å±‚çš„ â€œCaused byâ€

   - å€’æ•°ç¬¬ä¸€è¡Œï¼šCaused by: java.lang.ClassNotFoundException: org.aspectj.lang.ProceedingJoinPoint

   - å€’æ•°ç¬¬äºŒè¡Œï¼šCaused by: java.lang.NoClassDefFoundError: org/aspectj/lang/ProceedingJoinPoint

3. åˆ†æå…ƒå‡¶

   ç¼ºä»€ä¹ˆç±»ï¼Ÿ org.aspectj.lang.ProceedingJoinPointã€‚

   å®ƒæ˜¯ @Around ç¯ç»•é€šçŸ¥é‡Œå¿…ç”¨çš„å‚æ•°ï¼Œç”¨æ¥æ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚

   **è°åœ¨ç”¨å®ƒï¼Ÿ** å¾€ä¸Šçœ‹å †æ ˆï¼ŒæŠ¥é”™çš„ Bean æ˜¯

      com.axel.demo.xxxxcommonutil.aop.aspect.TraceMapperAspectã€‚

4. ç»“è®ºï¼šé¡¹ç›®ä¸­æœ‰ä¸€ä¸ªåˆ‡é¢ç±» TraceMapperAspectï¼Œå®ƒä¾èµ–äº† AspectJ çš„åº“ï¼Œä½†æ˜¯é¡¹ç›®é‡Œæ²¡æœ‰å¼•å…¥ AspectJ çš„ Jar åŒ…



>ğŸ’­ ç¼º jar åŒ…ä¸ºä»€ä¹ˆæ²¡åœ¨ç¼–è¯‘æœŸå‘ç°ï¼Ÿ
>
>ç¼–è¯‘å™¨ï¼ˆjavacï¼‰åªæ£€æŸ¥ â€œè¯­æ³•â€ å’Œ â€œç±»å‹â€
>å½“æ‰§è¡Œ mv n complie æ—¶ï¼Œæˆ– IDE ç¼–è¯‘ä»£ç æ—¶ï¼Œæµç¨‹ä¸ºï¼š
>
>1. è¯­æ³•æ£€æŸ¥ï¼šä»£ç æ˜¯å¦å†™é”™ï¼Œå¦‚å°‘ä¸ªåˆ†å·ï¼Œæ‹¼å†™é”™è¯¯ã€‚
>2. ç±»å‹æ£€æŸ¥ï¼šå¼•ç”¨çš„ç±»æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠè°ƒç”¨çš„æ–¹æ³•æ˜¯å¦å­˜åœ¨äºè¯¥ç±»ä¸­ã€‚
>
>ä¸Šè¿°å‡ºç°æŠ¥é”™å…¶å®æ˜¯ç”±è¿™å‡ ä¸ªç›´æ¥åŸå› é€ æˆï¼š
>
>1. IDEA ä¸­çš„æ£€é”™ä»…å¯¹å·¥ä½œåŒºä»£ç æ£€é”™ã€‚
>2. å®ç°çš„é¡¹ç›®å¼•å…¥äº†ä¸€ä¸ª Common åŒ…ï¼Œè¯¥ Common åŒ…åŸºäº provide å¼•å…¥äº† aop (provided æ§åˆ¶è¯¥ jar åŒ…ä»…åœ¨ç¼–è¯‘æœŸå¯è§ï¼Œåœ¨è¿è¡ŒæœŸä¸å¯è§ï¼Œæ‰€ä»¥è¿è¡Œæ—¶ä¼šæŠ¥é”™)



### ğŸ”– 03 ä¾èµ–ç‰ˆæœ¬ä¸å…¼å®¹

```markdown
org.springframework.context.ApplicationContextException: Failed to start bean '**redisHealthProbe**'; nested exception is java.lang.NoClassDefFoundError: org/springframework/data/redis/connection/zset/Tuple
        at org.springframework**=.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.22.jar!/:5.3.22]
        at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.22.jar!/:5.3.22]
        at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.22.jar!/:5.3.22]
        at java.lang.Iterable.forEach(Iterable.java:75) ~[?:1.8.0_412]
        at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.22.jar!/:5.3.22]
        at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.22.jar!/:5.3.22]
        at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:935) ~[spring-context-5.3.22.jar!/:5.3.22]
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.22.jar!/:5.3.22]
        at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:145) ~[spring-boot-2.6.11.jar!/:2.6.11]
        at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:745) ~[spring-boot-2.6.11.jar!/:2.6.11]
        at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:420) ~[spring-boot-2.6.11.jar!/:2.6.11]
        at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.6.11.jar!/:2.6.11]
        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1317) ~[spring-boot-2.6.11.jar!/:2.6.11]
        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1306) ~[spring-boot-2.6.11.jar!/:2.6.11]
        at com.axel.demo.aimusic.operation.xxxxAiMusicOperationApplication.main(xxxxAiMusicOperationApplication.java:26) ~[classes!/:1.0-SNAPSHOT]
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_412]
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_412]
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_412]
        at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_412]
        at org.springframework.boot.loader.MainMethodRunner.run(MainMethodRunner.java:49) ~[app.jar:1.0-SNAPSHOT]
        at org.springframework.boot.loader.Launcher.launch(Launcher.java:108) ~[app.jar:1.0-SNAPSHOT]
        at org.springframework.boot.loader.Launcher.launch(Launcher.java:58) ~[app.jar:1.0-SNAPSHOT]
        at org.springframework.boot.loader.JarLauncher.main(JarLauncher.java:88) ~[app.jar:1.0-SNAPSHOT]
Caused by: java.lang.NoClassDefFoundError: org/springframework/data/redis/connection/zset/Tuple
        at org.redisson.spring.data.connection.RedissonConnection.<clinit>(RedissonConnection.java:2361) ~[redisson-spring-data-31-3.24.3.jar!/:3.24.3]
        at org.redisson.spring.data.connection.RedissonConnectionFactory.getConnection(RedissonConnectionFactory.java:113) ~[redisson-spring-data-31-3.24.3.jar!/:3.24.3]
        at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:92) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at com.axel.demo.starter.health.probe.RedisHealthProbe.startupProbe(RedisHealthProbe.java:32) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at com.axel.demo.starter.health.util.HealthUtil.handleProbeState(HealthUtil.java:61) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at com.axel.demo.starter.health.util.HealthUtil.handleProbeStateWithRetry(HealthUtil.java:37) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at com.axel.demo.starter.health.probe.AbstractHealthProbe.start(AbstractHealthProbe.java:35) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.22.jar!/:5.3.22]
        ... 22 more
Caused by: java.lang.ClassNotFoundException: org.springframework.data.redis.connection.zset.Tuple
        at java.net.URLClassLoader.findClass(URLClassLoader.java:387) ~[?:1.8.0_412]
        at java.lang.ClassLoader.loadClass(ClassLoader.java:418) ~[?:1.8.0_412]
        at org.springframework.boot.loader.LaunchedURLClassLoader.loadClass(LaunchedURLClassLoader.java:151) ~[app.jar:1.0-SNAPSHOT]
        at java.lang.ClassLoader.loadClass(ClassLoader.java:351) ~[?:1.8.0_412]
        at org.redisson.spring.data.connection.RedissonConnection.<clinit>(RedissonConnection.java:2361) ~[redisson-spring-data-31-3.24.3.jar!/:3.24.3]
        at org.redisson.spring.data.connection.RedissonConnectionFactory.getConnection(RedissonConnectionFactory.java:113) ~[redisson-spring-data-31-3.24.3.jar!/:3.24.3]
        at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:92) ~[spring-data-redis-2.6.6.jar!/:2.6.6]
        at com.axel.demo.starter.health.probe.RedisHealthProbe.startupProbe(RedisHealthProbe.java:32) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at com.axel.demo.starter.health.util.HealthUtil.handleProbeState(HealthUtil.java:61) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at com.axel.demo.starter.health.util.HealthUtil.handleProbeStateWithRetry(HealthUtil.java:37) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at com.axel.demo.starter.health.probe.AbstractHealthProbe.start(AbstractHealthProbe.java:35) ~[xxxx-core-starter-1.7.30.jar!/:1.7.30]
        at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.22.jar!/:5.3.22]
```

1. æ— è§†è¡¨è±¡

  **æŠ¥é”™ä¿¡æ¯**ï¼šFailed to start bean 'redisHealthProbe'ï¼ˆæ— æ³•å¯åŠ¨ Redis å¥åº·æ£€æŸ¥æ¢é’ˆï¼‰
  **è§£è¯»**ï¼šSpring Boot åœ¨å¯åŠ¨å¥åº·æ£€æŸ¥ç»„ä»¶æ—¶æŒ‚äº†ã€‚è¿™åªæ˜¯å—å®³è€…ï¼Œè¯´æ˜é—®é¢˜å‡ºåœ¨Redis å»ºç«‹è¿æ¥çš„ç¯èŠ‚ã€‚

2. å¯»æ‰¾æœ€åº•å±‚çš„ â€œCaused by

 å€’æ•°ç¬¬ä¸€è¡Œï¼šCaused by: java.lang.ClassNotFoundException: 

   org.springframework.data.redis.connection.zset.Tuple

  å€’æ•°ç¬¬äºŒè¡Œï¼šCaused by: java.lang.NoClassDefFoundError: 

   org/springframework/data/redis/connection/zset/Tuple

3. åˆ†æå…ƒå‡¶
   ç¼ºä»€ä¹ˆç±»ï¼Ÿ org.springframework.data.redis.connection.zset.Tuple
   è°åœ¨ç”¨å®ƒï¼Ÿ å¾€ä¸Šçœ‹å †æ ˆï¼ŒæŠ¥é”™çš„è°ƒç”¨æ–¹æ˜¯ï¼šorg.redisson.spring.data.connection.RedissonConnection.
   å…³é”®çº¿ç´¢
   è°ƒç”¨è€…ï¼ˆå‡¶æ‰‹ï¼šredisson-spring-data-31-3.24.3.jarã€‚æ³¨æ„æ–‡ä»¶åé‡Œçš„ **`31`**ï¼Œè¿™ä»£è¡¨å®ƒé€‚é…çš„æ˜¯
   Spring Data Redis 3.1ï¼ˆå³ Spring Boot 3.xï¼‰ã€‚
   ç¯å¢ƒï¼ˆå®¿ä¸»ï¼‰ï¼šspring-data-redis-2.6.6.jarã€‚æ³¨æ„æ–‡ä»¶åé‡Œçš„ **`2.6.6`**ï¼Œè¯´æ˜å½“å‰é¡¹ç›®è¿è¡Œçš„æ˜¯ Spring Boot 2.6ã€‚

4. ç»“è®º
   ç»“è®º ï¼šå…¸å‹çš„ç‰ˆæœ¬ä¸å…¼å®¹ã€‚Redisson çš„ Jar åŒ…ï¼ˆé€‚é… Spring Boot 3.xï¼‰è¯•å›¾å»è°ƒç”¨ Spring Data Redis

   3.x æ‰æœ‰çš„ç±»ç»“æ„ï¼Œä½†é¡¹ç›®ç¯å¢ƒæ˜¯ Spring Boot 2.xï¼Œå¯¼è‡´æ‰¾ä¸åˆ°ç±»ã€‚
   è§£å†³ï¼šä¿®æ”¹ pom.xmlï¼Œå°† Redisson é™çº§åˆ°é€‚é… Spring Boot 2.x çš„ç‰ˆæœ¬ï¼ˆå¦‚ 3.17.xï¼‰ï¼Œæˆ–è€…åœ¨ä¾èµ–ä¸­æ’é™¤
   redisson-spring-data-31 å¹¶æ‰‹åŠ¨å¼•å…¥ redisson-spring-data-26ã€‚

### ğŸ”– 04 å¾ªç¯ä¾èµ–

```markdown
***************************
APPLICATION FAILED TO START
***************************

Description:

The dependencies of some of the beans in the application context form a cycle:

   nacosConfigurationPropertiesBindingPostProcessor
      â†“
   metaDataSourceAdvisor
â”Œâ”€â”€â”€â”€â”€â”
|  com.xxxxoa.infra.oaucf.newauth.autoconfig.authority.UcAuthorityMethodSecurityConfiguration
â””â”€â”€â”€â”€â”€â”˜
```

**åˆ†æï¼š**

 Spring Boot 2.6.0 ç‰ˆæœ¬å¼€å§‹ï¼Œ**é»˜è®¤ç¦æ­¢äº† Bean çš„å¾ªç¯ä¾èµ–**ï¼ˆCircular Referencesï¼‰

å½¢æˆäº†ä¸€ä¸ªé—­ç¯ï¼š

1. nacosConfigurationPropertiesBindingPostProcessor (Nacos çš„é…ç½®ç»‘å®šå¤„ç†å™¨)
2. ä¾èµ– -> metaDataSourceAdvisor (æ•°æ®æºç›¸å…³çš„åˆ‡é¢)
3. ä¾èµ– -> UcAuthorityMethodSecurityConfiguration (æƒé™å®‰å…¨é…ç½®ç±»)
4. ä¾èµ– -> nacosConfigurationPropertiesBindingPostProcessor (é—­ç¯å½¢æˆ)

è¿™é€šå¸¸å› ä¸º UcAuthorityMethodSecurityConfiguration ç±»ä¸­å¯èƒ½æ³¨å…¥äº†æŸäº›éœ€è¦è¯»å– Nacos é…ç½®çš„ Beanï¼Œæˆ–è€…è¯¥é…ç½®ç±»æœ¬èº«å°±åœ¨è¿›è¡Œå±æ€§ç»‘å®šï¼Œå¯¼è‡´åˆå§‹åŒ–é¡ºåºçš„æ­»é”

**è§£å†³æ–¹æ³•ï¼š**

1. *å…è®¸å¾ªç¯ä¾èµ–*

   ```yaml
   spring:
   	main:
   		allow-circular-references: true
   ```

2. *ä½¿ç”¨* *@Lazy* *æ‰“ç ´å¾ªç¯ï¼ˆä»£ç ä¿®å¤ï¼‰*

----

### ğŸ”– next





## ğŸ“ prompt

```markdown
# èƒŒæ™¯
Java Spring åç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œæˆ‘åœ¨æ­å»ºä¸€ä¸ªæ–°çš„ Spring é¡¹ç›®å‘¢ã€‚æœŸé—´é‡åˆ°äº†å„ç§å„æ ·çš„å¯åŠ¨æŠ¥é”™ã€‚æˆ‘å¸Œæœ›å¯¹å®ƒä»¬åšä¸€ä¸ªæ€»ç»“ï¼Œå¹¶ä¸”å½¢æˆä¸€ä¸ªè§‚å¯Ÿæ—¥å¿—æŠ¥é”™æ’æŸ¥çš„è®¡åˆ’åŠä¹ æƒ¯ã€‚
```
